name: comfyui-docker
services:
  comfyui:
    image: dasbrotimofen/comfyui-truenas-fixed:latest
    container_name: comfyui
    restart: unless-stopped
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      - UID=1000
      - GID=1000
    ports:
      - "8188:8188"
    volumes:
      - "/mnt/MEGA-Storage/Docker-tests/comfyui/models:/opt/comfyui/models:rw"
      - "/mnt/MEGA-Storage/Docker-tests/comfyui/output:/opt/comfyui/output:rw"
